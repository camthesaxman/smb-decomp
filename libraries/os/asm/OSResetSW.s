.include "macros.inc"

.section .text, "ax"  # 0x800065A0 - 0x8010F860

.global __OSResetSWInterruptHandler
__OSResetSWInterruptHandler:
/* 800C7588 000C34A8  7C 08 02 A6 */	mflr r0
/* 800C758C 000C34AC  90 01 00 04 */	stw r0, 4(r1)
/* 800C7590 000C34B0  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 800C7594 000C34B4  93 E1 00 24 */	stw r31, 0x24(r1)
/* 800C7598 000C34B8  93 C1 00 20 */	stw r30, 0x20(r1)
/* 800C759C 000C34BC  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 800C75A0 000C34C0  48 00 23 FD */	bl __OSGetSystemTime
/* 800C75A4 000C34C4  3C A0 80 00 */	lis r5, 0x800000F8@ha
/* 800C75A8 000C34C8  90 8D A1 64 */	stw r4, lbl_802F2344@sda21(r13)
/* 800C75AC 000C34CC  80 05 00 F8 */	lwz r0, 0x800000F8@l(r5)
/* 800C75B0 000C34D0  3C 80 43 1C */	lis r4, 0x431BDE83@ha
/* 800C75B4 000C34D4  38 84 DE 83 */	addi r4, r4, 0x431BDE83@l
/* 800C75B8 000C34D8  90 6D A1 60 */	stw r3, HoldDown@sda21(r13)
/* 800C75BC 000C34DC  54 00 F0 BE */	srwi r0, r0, 2
/* 800C75C0 000C34E0  7C 04 00 16 */	mulhwu r0, r4, r0
/* 800C75C4 000C34E4  54 00 8B FE */	srwi r0, r0, 0xf
/* 800C75C8 000C34E8  1C 00 00 64 */	mulli r0, r0, 0x64
/* 800C75CC 000C34EC  54 1D E8 FE */	srwi r29, r0, 3
/* 800C75D0 000C34F0  3B C0 00 00 */	li r30, 0
/* 800C75D4 000C34F4  3F E0 CC 00 */	lis r31, 0xcc00
lbl_800C75D8:
/* 800C75D8 000C34F8  48 00 23 C5 */	bl __OSGetSystemTime
/* 800C75DC 000C34FC  80 CD A1 64 */	lwz r6, lbl_802F2344@sda21(r13)
/* 800C75E0 000C3500  6F C5 80 00 */	xoris r5, r30, 0x8000
/* 800C75E4 000C3504  80 0D A1 60 */	lwz r0, HoldDown@sda21(r13)
/* 800C75E8 000C3508  7C 86 20 10 */	subfc r4, r6, r4
/* 800C75EC 000C350C  7C 00 19 10 */	subfe r0, r0, r3
/* 800C75F0 000C3510  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 800C75F4 000C3514  7C 1D 20 10 */	subfc r0, r29, r4
/* 800C75F8 000C3518  7C A5 19 10 */	subfe r5, r5, r3
/* 800C75FC 000C351C  7C A3 19 10 */	subfe r5, r3, r3
/* 800C7600 000C3520  7C A5 00 D1 */	neg. r5, r5
/* 800C7604 000C3524  41 82 00 10 */	beq lbl_800C7614
/* 800C7608 000C3528  80 1F 30 00 */	lwz r0, 0x3000(r31)
/* 800C760C 000C352C  54 00 03 DF */	rlwinm. r0, r0, 0, 0xf, 0xf
/* 800C7610 000C3530  41 82 FF C8 */	beq lbl_800C75D8
lbl_800C7614:
/* 800C7614 000C3534  3C 60 CC 00 */	lis r3, 0xCC003000@ha
/* 800C7618 000C3538  80 03 30 00 */	lwz r0, 0xCC003000@l(r3)
/* 800C761C 000C353C  54 00 03 DF */	rlwinm. r0, r0, 0, 0xf, 0xf
/* 800C7620 000C3540  40 82 00 34 */	bne lbl_800C7654
/* 800C7624 000C3544  38 00 00 01 */	li r0, 1
/* 800C7628 000C3548  90 0D A1 4C */	stw r0, Down@sda21(r13)
/* 800C762C 000C354C  38 60 02 00 */	li r3, 0x200
/* 800C7630 000C3550  90 0D A1 50 */	stw r0, LastState@sda21(r13)
/* 800C7634 000C3554  4B FF EE 29 */	bl __OSMaskInterrupts
/* 800C7638 000C3558  81 8D A1 48 */	lwz r12, ResetCallback@sda21(r13)
/* 800C763C 000C355C  28 0C 00 00 */	cmplwi r12, 0
/* 800C7640 000C3560  41 82 00 14 */	beq lbl_800C7654
/* 800C7644 000C3564  38 00 00 00 */	li r0, 0
/* 800C7648 000C3568  7D 88 03 A6 */	mtlr r12
/* 800C764C 000C356C  90 0D A1 48 */	stw r0, ResetCallback@sda21(r13)
/* 800C7650 000C3570  4E 80 00 21 */	blrl
lbl_800C7654:
/* 800C7654 000C3574  38 00 00 02 */	li r0, 2
/* 800C7658 000C3578  3C 60 CC 00 */	lis r3, 0xCC003000@ha
/* 800C765C 000C357C  90 03 30 00 */	stw r0, 0xCC003000@l(r3)
/* 800C7660 000C3580  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 800C7664 000C3584  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 800C7668 000C3588  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 800C766C 000C358C  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 800C7670 000C3590  38 21 00 28 */	addi r1, r1, 0x28
/* 800C7674 000C3594  7C 08 03 A6 */	mtlr r0
/* 800C7678 000C3598  4E 80 00 20 */	blr

.global OSGetResetButtonState
OSGetResetButtonState:
/* 800C767C 000C359C  7C 08 02 A6 */	mflr r0
/* 800C7680 000C35A0  90 01 00 04 */	stw r0, 4(r1)
/* 800C7684 000C35A4  94 21 FF E8 */	stwu r1, -0x18(r1)
/* 800C7688 000C35A8  93 E1 00 14 */	stw r31, 0x14(r1)
/* 800C768C 000C35AC  93 C1 00 10 */	stw r30, 0x10(r1)
/* 800C7690 000C35B0  93 A1 00 0C */	stw r29, 0xc(r1)
/* 800C7694 000C35B4  4B FF EA 29 */	bl OSDisableInterrupts
/* 800C7698 000C35B8  3C 80 CC 00 */	lis r4, 0xCC003000@ha
/* 800C769C 000C35BC  80 04 30 00 */	lwz r0, 0xCC003000@l(r4)
/* 800C76A0 000C35C0  3B A3 00 00 */	addi r29, r3, 0
/* 800C76A4 000C35C4  54 00 03 DF */	rlwinm. r0, r0, 0, 0xf, 0xf
/* 800C76A8 000C35C8  40 82 00 E4 */	bne lbl_800C778C
/* 800C76AC 000C35CC  80 0D A1 4C */	lwz r0, Down@sda21(r13)
/* 800C76B0 000C35D0  2C 00 00 00 */	cmpwi r0, 0
/* 800C76B4 000C35D4  40 82 00 44 */	bne lbl_800C76F8
/* 800C76B8 000C35D8  80 0D A1 58 */	lwz r0, HoldUp@sda21(r13)
/* 800C76BC 000C35DC  38 80 00 00 */	li r4, 0
/* 800C76C0 000C35E0  80 6D A1 5C */	lwz r3, lbl_802F233C@sda21(r13)
/* 800C76C4 000C35E4  38 A0 00 01 */	li r5, 1
/* 800C76C8 000C35E8  7C 00 22 78 */	xor r0, r0, r4
/* 800C76CC 000C35EC  7C 63 22 78 */	xor r3, r3, r4
/* 800C76D0 000C35F0  90 AD A1 4C */	stw r5, Down@sda21(r13)
/* 800C76D4 000C35F4  7C 60 03 79 */	or. r0, r3, r0
/* 800C76D8 000C35F8  41 82 00 08 */	beq lbl_800C76E0
/* 800C76DC 000C35FC  48 00 00 08 */	b lbl_800C76E4
lbl_800C76E0:
/* 800C76E0 000C3600  7C 85 23 78 */	mr r5, r4
lbl_800C76E4:
/* 800C76E4 000C3604  7C BE 2B 78 */	mr r30, r5
/* 800C76E8 000C3608  48 00 22 B5 */	bl __OSGetSystemTime
/* 800C76EC 000C360C  90 8D A1 64 */	stw r4, lbl_802F2344@sda21(r13)
/* 800C76F0 000C3610  90 6D A1 60 */	stw r3, HoldDown@sda21(r13)
/* 800C76F4 000C3614  48 00 01 50 */	b lbl_800C7844
lbl_800C76F8:
/* 800C76F8 000C3618  80 0D A1 58 */	lwz r0, HoldUp@sda21(r13)
/* 800C76FC 000C361C  3B E0 00 00 */	li r31, 0
/* 800C7700 000C3620  80 6D A1 5C */	lwz r3, lbl_802F233C@sda21(r13)
/* 800C7704 000C3624  3B C0 00 01 */	li r30, 1
/* 800C7708 000C3628  7C 00 FA 78 */	xor r0, r0, r31
/* 800C770C 000C362C  7C 63 FA 78 */	xor r3, r3, r31
/* 800C7710 000C3630  7C 60 03 79 */	or. r0, r3, r0
/* 800C7714 000C3634  40 82 00 5C */	bne lbl_800C7770
/* 800C7718 000C3638  48 00 22 85 */	bl __OSGetSystemTime
/* 800C771C 000C363C  3C A0 80 00 */	lis r5, 0x800000F8@ha
/* 800C7720 000C3640  80 ED A1 64 */	lwz r7, lbl_802F2344@sda21(r13)
/* 800C7724 000C3644  80 05 00 F8 */	lwz r0, 0x800000F8@l(r5)
/* 800C7728 000C3648  3C A0 43 1C */	lis r5, 0x431BDE83@ha
/* 800C772C 000C364C  38 A5 DE 83 */	addi r5, r5, 0x431BDE83@l
/* 800C7730 000C3650  80 CD A1 60 */	lwz r6, HoldDown@sda21(r13)
/* 800C7734 000C3654  54 00 F0 BE */	srwi r0, r0, 2
/* 800C7738 000C3658  7C 05 00 16 */	mulhwu r0, r5, r0
/* 800C773C 000C365C  54 00 8B FE */	srwi r0, r0, 0xf
/* 800C7740 000C3660  1C 00 00 64 */	mulli r0, r0, 0x64
/* 800C7744 000C3664  7C A7 20 10 */	subfc r5, r7, r4
/* 800C7748 000C3668  7C 66 19 10 */	subfe r3, r6, r3
/* 800C774C 000C366C  54 00 E8 FE */	srwi r0, r0, 3
/* 800C7750 000C3670  6F E4 80 00 */	xoris r4, r31, 0x8000
/* 800C7754 000C3674  6C 63 80 00 */	xoris r3, r3, 0x8000
/* 800C7758 000C3678  7C 05 00 10 */	subfc r0, r5, r0
/* 800C775C 000C367C  7C 63 21 10 */	subfe r3, r3, r4
/* 800C7760 000C3680  7C 64 21 10 */	subfe r3, r4, r4
/* 800C7764 000C3684  7C 63 00 D1 */	neg. r3, r3
/* 800C7768 000C3688  40 82 00 08 */	bne lbl_800C7770
/* 800C776C 000C368C  7F FE FB 78 */	mr r30, r31
lbl_800C7770:
/* 800C7770 000C3690  2C 1E 00 00 */	cmpwi r30, 0
/* 800C7774 000C3694  41 82 00 0C */	beq lbl_800C7780
/* 800C7778 000C3698  38 00 00 01 */	li r0, 1
/* 800C777C 000C369C  48 00 00 08 */	b lbl_800C7784
lbl_800C7780:
/* 800C7780 000C36A0  38 00 00 00 */	li r0, 0
lbl_800C7784:
/* 800C7784 000C36A4  7C 1E 03 78 */	mr r30, r0
/* 800C7788 000C36A8  48 00 00 BC */	b lbl_800C7844
lbl_800C778C:
/* 800C778C 000C36AC  80 0D A1 4C */	lwz r0, Down@sda21(r13)
/* 800C7790 000C36B0  2C 00 00 00 */	cmpwi r0, 0
/* 800C7794 000C36B4  41 82 00 2C */	beq lbl_800C77C0
/* 800C7798 000C36B8  80 6D A1 50 */	lwz r3, LastState@sda21(r13)
/* 800C779C 000C36BC  38 00 00 00 */	li r0, 0
/* 800C77A0 000C36C0  90 0D A1 4C */	stw r0, Down@sda21(r13)
/* 800C77A4 000C36C4  2C 03 00 00 */	cmpwi r3, 0
/* 800C77A8 000C36C8  3B C3 00 00 */	addi r30, r3, 0
/* 800C77AC 000C36CC  41 82 00 98 */	beq lbl_800C7844
/* 800C77B0 000C36D0  48 00 21 ED */	bl __OSGetSystemTime
/* 800C77B4 000C36D4  90 8D A1 5C */	stw r4, lbl_802F233C@sda21(r13)
/* 800C77B8 000C36D8  90 6D A1 58 */	stw r3, HoldUp@sda21(r13)
/* 800C77BC 000C36DC  48 00 00 88 */	b lbl_800C7844
lbl_800C77C0:
/* 800C77C0 000C36E0  80 0D A1 58 */	lwz r0, HoldUp@sda21(r13)
/* 800C77C4 000C36E4  3B C0 00 00 */	li r30, 0
/* 800C77C8 000C36E8  80 6D A1 5C */	lwz r3, lbl_802F233C@sda21(r13)
/* 800C77CC 000C36EC  7C 00 F2 78 */	xor r0, r0, r30
/* 800C77D0 000C36F0  7C 63 F2 78 */	xor r3, r3, r30
/* 800C77D4 000C36F4  7C 60 03 79 */	or. r0, r3, r0
/* 800C77D8 000C36F8  41 82 00 5C */	beq lbl_800C7834
/* 800C77DC 000C36FC  48 00 21 C1 */	bl __OSGetSystemTime
/* 800C77E0 000C3700  3C A0 80 00 */	lis r5, 0x800000F8@ha
/* 800C77E4 000C3704  80 ED A1 5C */	lwz r7, lbl_802F233C@sda21(r13)
/* 800C77E8 000C3708  80 05 00 F8 */	lwz r0, 0x800000F8@l(r5)
/* 800C77EC 000C370C  3C A0 10 62 */	lis r5, 0x10624DD3@ha
/* 800C77F0 000C3710  38 A5 4D D3 */	addi r5, r5, 0x10624DD3@l
/* 800C77F4 000C3714  80 CD A1 58 */	lwz r6, HoldUp@sda21(r13)
/* 800C77F8 000C3718  54 00 F0 BE */	srwi r0, r0, 2
/* 800C77FC 000C371C  7C 05 00 16 */	mulhwu r0, r5, r0
/* 800C7800 000C3720  54 00 D1 BE */	srwi r0, r0, 6
/* 800C7804 000C3724  1C 00 00 28 */	mulli r0, r0, 0x28
/* 800C7808 000C3728  7C A7 20 10 */	subfc r5, r7, r4
/* 800C780C 000C372C  7C 66 19 10 */	subfe r3, r6, r3
/* 800C7810 000C3730  6C 64 80 00 */	xoris r4, r3, 0x8000
/* 800C7814 000C3734  6F C3 80 00 */	xoris r3, r30, 0x8000
/* 800C7818 000C3738  7C 00 28 10 */	subfc r0, r0, r5
/* 800C781C 000C373C  7C 63 21 10 */	subfe r3, r3, r4
/* 800C7820 000C3740  7C 64 21 10 */	subfe r3, r4, r4
/* 800C7824 000C3744  7C 63 00 D1 */	neg. r3, r3
/* 800C7828 000C3748  41 82 00 0C */	beq lbl_800C7834
/* 800C782C 000C374C  3B C0 00 01 */	li r30, 1
/* 800C7830 000C3750  48 00 00 14 */	b lbl_800C7844
lbl_800C7834:
/* 800C7834 000C3754  38 00 00 00 */	li r0, 0
/* 800C7838 000C3758  90 0D A1 5C */	stw r0, lbl_802F233C@sda21(r13)
/* 800C783C 000C375C  3B C0 00 00 */	li r30, 0
/* 800C7840 000C3760  90 0D A1 58 */	stw r0, HoldUp@sda21(r13)
lbl_800C7844:
/* 800C7844 000C3764  93 CD A1 50 */	stw r30, LastState@sda21(r13)
/* 800C7848 000C3768  7F A3 EB 78 */	mr r3, r29
/* 800C784C 000C376C  4B FF E8 99 */	bl OSRestoreInterrupts
/* 800C7850 000C3770  80 01 00 1C */	lwz r0, 0x1c(r1)
/* 800C7854 000C3774  7F C3 F3 78 */	mr r3, r30
/* 800C7858 000C3778  83 E1 00 14 */	lwz r31, 0x14(r1)
/* 800C785C 000C377C  83 C1 00 10 */	lwz r30, 0x10(r1)
/* 800C7860 000C3780  7C 08 03 A6 */	mtlr r0
/* 800C7864 000C3784  83 A1 00 0C */	lwz r29, 0xc(r1)
/* 800C7868 000C3788  38 21 00 18 */	addi r1, r1, 0x18
/* 800C786C 000C378C  4E 80 00 20 */	blr

.section .sbss

.global ResetCallback
ResetCallback:
	.skip 0x4
.global Down
Down:
	.skip 0x4
.global LastState
LastState:
	.skip 0x8
.global HoldUp
HoldUp:
	.skip 0x4
.global lbl_802F233C
lbl_802F233C:
	.skip 0x4
.global HoldDown
HoldDown:
	.skip 0x4
.global lbl_802F2344
lbl_802F2344:
	.skip 0x4
